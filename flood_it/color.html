<DOCTYPE html>
<html>
<head>
</head>

<body>
<canvas></canvas>
<script src="http://jashkenas.github.io/coffee-script/extras/coffee-script.js"></script>
<script type="text/coffeescript">
_floor = Math.floor
_abs = Math.abs

canvas = document.querySelector('canvas')
ctx = canvas.getContext('2d')

canvas.style.width = canvas.width = w = 800
canvas.style.height = canvas.height = h = 600

# block size
s = 2

from_hsl = (h, s, l) ->
  c = (1 - _abs(2*l - 1)) * s

  h1 = h / 60
  x = c * (1 - _abs(h1%2 - 1))
  rgb = switch
    when h1 < 1 then [c, x, 0]
    when h1 < 2 then [x, c, 0]
    when h1 < 3 then [0, c, x]
    when h1 < 4 then [0, x, c]
    when h1 < 5 then [x, 0, c]
    when h1 < 6 then [c, 0, x]
    else [0, 0, 0]

  m = l - c/2
  [rgb[0] + m, rgb[1] + m, rgb[2] + m]

for i in [0..h] by s
  for j in [0..w] by s
    rgb = from_hsl(j * 360/w, i/h, 1.0 - i/h)
    ctx.fillStyle = "rgb(#{_floor(rgb[0] * 255)}, #{_floor(rgb[1] * 255)}, #{_floor(rgb[2] * 255)})"
    ctx.fillRect(j, i, s, s)

# links
# http://en.wikipedia.org/wiki/HSL_and_HSV#Hue_and_chroma
</script>
</body>
</html>
